<!DOCTYPE html>
<html>
<head>
<title>NotatnikTras</title>
<meta charset="utf-8" />
<style type="text/css">
	*
	{
		padding: 0;
		margin: 0;
		font-size: 2.5vh;
		background: rgba(0,0,0,0);
		color: white;
	}
	body
	{
		background: #070707;
		font-family: ariel;
	}
	#glowny
	{
		position: relative;
		top: 1vh;
		width: 40vh;
		min-height: 80vh;
		left: 50%;
		margin-left: -20vh;
		background: black;
	}
	.przedzial
	{
		height: 5vh;
		padding-top: 0.25vh;
		padding-bottom: 0.25vh;
	}
	.guzikPlusMinus
	{
		box-sizing: border-box;
		height: 4.5vh;
		width: 4.5vh;
		border-radius: 1vh;
		border: solid 0.5vh white;
		margin: 0.25vh;
		text-align: center;
		font-weight: 700;
		font-size: 2.7vh;
		float: left;
	}
	.wartosc
	{
		box-sizing: border-box;
		height: 4.5vh;
		width: 19.5vh;
		border-radius: 1vh;
		border: solid 0.5vh white;
		margin: 0.25vh;
		text-align: center;
		font-weight: 500;
		font-size: 2.7vh;
		float: left;
	}
	.wartoscMala
	{
		width: 19.5vh;
	}
	.wartoscSrednia
	{
		width: 29.5vh;
	}
	.wartoscDuza
	{
		width: 39.5vh;
	}
	.nieklikalna
	{
		border-color: #7F7F7F;
		color: #EDEDED;
		border-radius: 1.5vh;
	}
	.separator
	{
		height: 3vh;
		width: 39vh;
		float: left;
	}
</style>
<script type="text/javascript">
	let trasaTeraz=0
	let wyszukaneTrasy=[]
	let edytowanaTrasa=0
	ekran=
	{
		czysc:function()
		{
			document.getElementById(`glowny`).innerHTML=""
		},
		wstaw:function(elementy)
		{
			document.getElementById(`glowny`).appendChild(elementy)
		},
		menuGlowne:function()
		{
			ekran.czysc()
			wyszukaneTrasy=[]
			const t=document.createElement("div")
			let element=document.createElement("div")
			element.className="wartosc wartoscDuza nieklikalna"
			element.innerHTML="Menu Główne"
			t.appendChild(element)
			element=document.createElement("div")
			element.className="separator"
			t.appendChild(element)
			//
			trasaTeraz=JSON.parse(localStorage.getItem("AgroNotatnik-trasaTeraz")||"0")
			if (trasaTeraz)
			{
				element=document.createElement("div")
				element.className="wartosc wartoscDuza nieklikalna"
				let przewidywanyCzas=8
				const trasa=JSON.parse(localStorage.getItem("AgroNotatnik-trasa-"+(trasaTeraz.nazwa||"?"))||"0")
				if (trasa && typeof trasa=="object")
				{
					if (trasa[1]>0.2)
					{
						przewidywanyCzas=trasa[1]+0.25
					}
				}
				element.innerHTML=`Szacowany koniec ${funkcjeCzasu.pokazGodzine(funkcjeCzasu.dodajMinuty(przewidywanyCzas*60,JSON.parse(JSON.stringify(trasaTeraz.czasStart)))[0])}`
				t.appendChild(element)
				element=document.createElement("div")
				element.className="wartosc wartoscDuza"
				element.innerHTML="Zakończ Trasę"
				element.style.borderColor="#D9F739"
				element.onclick=ekran.koniec
				t.appendChild(element)
				element=document.createElement("div")
				element.className="wartosc wartoscDuza"
				element.innerHTML="Anuluj Trasę"
				element.style.borderColor="#F74D39"
				element.onclick=anulujTrase
				t.appendChild(element)
			}
			else
			{
				element=document.createElement("div")
				element.className="wartosc wartoscDuza"
				element.innerHTML="Nowa Trasa"
				element.style.borderColor="#D9F739"
				element.onclick=ekran.nowa
				t.appendChild(element)
			}
			element=document.createElement("div")
			element.className="separator"
			t.appendChild(element)
			element=document.createElement("div")
			element.className="wartosc wartoscDuza"
			element.innerHTML="Statystyki"
			element.onclick=ekran.statystyki
			t.appendChild(element)
			element=document.createElement("div")
			element.className="wartosc wartoscDuza"
			element.innerHTML="Wydruk dla Szefa"
			element.onclick=ekran.dlaSzefa
			t.appendChild(element)
			element=document.createElement("div")
			element.className="wartosc wartoscDuza"
			const listaTras=JSON.parse(localStorage.getItem("AgroNotatnik-listaTras")||"[0]")||[0]
			if (listaTras.length>1)
			{
				element=document.createElement("div")
				element.className="separator"
				t.appendChild(element)
				element=document.createElement("div")
				element.className="wartosc wartoscDuza"
				element.innerHTML="Ostatnie Trasy:"
				element.onclick=ekran.wszystkieTrasy
				t.appendChild(element)
				let z=7
				for (let a=listaTras.length-1 ; a>0 ; a--)
				{
					if (z<1){break}
					element=document.createElement("div")
					element.className="wartosc wartoscDuza"
					element.innerHTML=`${funkcjeCzasu.dzienTygodnia(listaTras[a][1])} ${listaTras[a][0]} w ${Math.floor(listaTras[a][2]/30)/2}h`
					element.onclick = new Function(`ekran.trasa(${a})`)
					t.appendChild(element)
					z--
				}
			}
			//
			ekran.wstaw(t)
		},
		elementCzas:function(nazwa)
		{
			const t=document.createElement("div")
			const aktualizuj=`document.getElementById('${nazwa}Div1').innerHTML=funkcjeCzasu.pokazDate(${nazwa}[1]);document.getElementById('${nazwa}Div2').innerHTML=funkcjeCzasu.pokazGodzine(${nazwa}[0])`
			//
			let przedzial=document.createElement("div")
			przedzial.className="przedzial"
			let element=document.createElement("div")
			element.className="guzikPlusMinus"
			element.innerHTML="+"
			element.onclick = new Function(`${nazwa}=funkcjeCzasu.dodajDzien(${nazwa});${aktualizuj}`)
			przedzial.appendChild(element)
			//
			element=document.createElement("div")
			element.id=`${nazwa}Div1`
			element.className="wartosc wartoscSrednia"
			przedzial.appendChild(element)
			//
			element=document.createElement("div")
			element.className="guzikPlusMinus"
			element.innerHTML="-"
			element.onclick = new Function(`${nazwa}=funkcjeCzasu.odejmijDzien(${nazwa});${aktualizuj}`)
			przedzial.appendChild(element)
			element=document.createElement("div")
			element.style.clear="both"
			przedzial.appendChild(element)
			//
			t.appendChild(przedzial)
			przedzial=document.createElement("div")
			przedzial.className="przedzial"
			//
			element=document.createElement("div")
			element.className="guzikPlusMinus"
			element.innerHTML="+"
			element.onclick = new Function(`${nazwa}=funkcjeCzasu.dodajMinuty(60,${nazwa});${aktualizuj};${nazwa}[2]=1`)
			przedzial.appendChild(element)
			//
			element=document.createElement("div")
			element.className="guzikPlusMinus"
			element.innerHTML="+"
			element.onclick = new Function(`${nazwa}=funkcjeCzasu.dodajMinuty(5,${nazwa});${aktualizuj};${nazwa}[2]=1`)
			przedzial.appendChild(element)
			//
			element=document.createElement("div")
			element.id=`${nazwa}Div2`
			element.className="wartosc wartoscMala"
			przedzial.appendChild(element)
			//
			element=document.createElement("div")
			element.className="guzikPlusMinus"
			element.innerHTML="-"
			element.onclick = new Function(`${nazwa}=funkcjeCzasu.dodajMinuty(-5,${nazwa});${aktualizuj};${nazwa}[2]=1`)
			przedzial.appendChild(element)
			//
			element=document.createElement("div")
			element.className="guzikPlusMinus"
			element.innerHTML="-"
			element.onclick = new Function(`${nazwa}=funkcjeCzasu.dodajMinuty(-60,${nazwa});${aktualizuj};${nazwa}[2]=1`)
			przedzial.appendChild(element)
			element=document.createElement("div")
			element.style.clear="both"
			przedzial.appendChild(element)
			//
			t.appendChild(przedzial)
			setTimeout(new Function(aktualizuj),1)
			return t
		},
		nowa:function()
		{
			ekran.czysc()
			if (!trasaTeraz)
			{
				trasaTeraz={czasStart:[funkcjeCzasu.aktualnaGodzina(),funkcjeCzasu.aktualnaData()]}
				trasaTeraz.czasStart[0][1]=Math.floor(trasaTeraz.czasStart[0][1]/5)*5
			}
			//
			const t=document.createElement("div")
			let element=document.createElement("div")
			element.className="wartosc wartoscDuza nieklikalna"
			element.innerHTML="Nowa Trasa"
			t.appendChild(element)
			element=document.createElement("div")
			element.className="separator"
			t.appendChild(element)
			t.appendChild(ekran.elementCzas("trasaTeraz.czasStart"))
			element=document.createElement("div")
			element.className="separator"
			t.appendChild(element)
			element=document.createElement("div")
			element.className="wartosc wartoscDuza nieklikalna"
			element.innerHTML="nazwa trasy"
			t.appendChild(element)
			element=document.createElement("input")
			element.className="wartosc wartoscDuza"
			element.style.borderColor="#4DCFF7"
			element.type="text"
			element.id="poleSzukaj"
			t.appendChild(element)
			element=document.createElement("div")
			element.className="separator"
			t.appendChild(element)
			element=document.createElement("div")
			element.className="wartosc wartoscDuza"
			element.innerHTML="utwórz nową"
			element.style.borderColor="#D9F739"
			element.onclick = new Function(`utworzNowaTrase()`)
			t.appendChild(element)
			element=document.createElement("div")
			element.className="wartosc wartoscDuza"
			element.innerHTML="wyszukaj"
			element.style.borderColor="#D9F739"
			element.onclick=szukajTrasy
			t.appendChild(element)
			if (wyszukaneTrasy.length>0)
			{
				element=document.createElement("div")
				element.className="separator"
				t.appendChild(element)
				element=document.createElement("div")
				element.className="wartosc wartoscDuza nieklikalna"
				element.innerHTML="wyszukane:"
				t.appendChild(element)
				for (let a=0 ; a<wyszukaneTrasy.length ; a++)
				{
					element=document.createElement("div")
					element.className="wartosc wartoscDuza"
					element.style.height=`7.5vh`
					if (wyszukaneTrasy[a][1]>0.24)
					{
						element.innerHTML=`${wyszukaneTrasy[a][0]}<br>średni czas: ${wyszukaneTrasy[a][1]}H`
					}
					else
					{
						element.innerHTML=`${wyszukaneTrasy[a][0]}`
					}
					element.onclick = new Function(`utworzNowaTrase("${wyszukaneTrasy[a][0]}")`)
					t.appendChild(element)
				}
			}
			element=document.createElement("div")
			element.className="wartosc wartoscDuza"
			element.innerHTML="wróć do menu"
			element.onclick=ekran.menuGlowne
			t.appendChild(element)
			//
			ekran.wstaw(t)
		},
		koniec:function()
		{
			ekran.czysc()
			trasaTeraz.czasKoniec=[funkcjeCzasu.aktualnaGodzina(),funkcjeCzasu.aktualnaData()]
			trasaTeraz.czasKoniec[0][1]=Math.ceil(trasaTeraz.czasKoniec[0][1]/5)*5
			//
			const t=document.createElement("div")
			let element=document.createElement("div")
			element.className="wartosc wartoscDuza nieklikalna"
			element.innerHTML="Zakończenie Trasy"
			t.appendChild(element)
			element=document.createElement("div")
			element.className="separator"
			t.appendChild(element)
			t.appendChild(ekran.elementCzas("trasaTeraz.czasKoniec"))
			element=document.createElement("div")
			element.className="separator"
			t.appendChild(element)
			element=document.createElement("div")
			element.className="wartosc wartoscDuza"
			element.innerHTML="Zapisz Przebieg Trasy"
			element.style.borderColor="#D9F739"
			element.onclick=zakonczTrase
			t.appendChild(element)
			element=document.createElement("div")
			element.className="wartosc wartoscDuza"
			element.innerHTML="wróć do menu"
			element.onclick=ekran.menuGlowne
			t.appendChild(element)
			ekran.wstaw(t)
		},
		wszystkieTrasy:function()
		{
			ekran.czysc()
			const t=document.createElement("div")
			let element=document.createElement("div")
			element.className="wartosc wartoscDuza"
			element.innerHTML="wróć do menu"
			element.onclick=ekran.menuGlowne
			t.appendChild(element)
			//
			const listaTras=JSON.parse(localStorage.getItem("AgroNotatnik-listaTras")||"[0]")||[0]
			let z=287
			for (let a=listaTras.length-1 ; a>0 ; a--)
			{
				if (listaTras[a] && z>0)
				{
					element=document.createElement("div")
					element.className="wartosc wartoscDuza"
					element.innerHTML=`${listaTras[a][1][0]}.${listaTras[a][1][1]} ${listaTras[a][0]} w ${Math.floor(listaTras[a][2]/30)/2}h`
					element.onclick = new Function(`ekran.trasa(${a})`)
					t.appendChild(element)
				}
				else
				{
					localStorage.setItem("AgroNotatnik-trasaNr-"+a,0)
					listaTras[a]=0
				}
			}
			localStorage.setItem("AgroNotatnik-listaTras",JSON.stringify(listaTras))
			ekran.wstaw(t)
		},
		statystyki:function()
		{
			ekran.czysc()
			const t=document.createElement("div")
			let element=document.createElement("div")
			element.className="wartosc wartoscDuza"
			element.innerHTML="wróć do menu"
			element.onclick=ekran.menuGlowne
			t.appendChild(element)
			element=document.createElement("div")
			element.className="separator"
			t.appendChild(element)
			//
			const listaTras=JSON.parse(localStorage.getItem("AgroNotatnik-listaTras")||"[0]")||[0]
			if (listaTras[0]>0.2)
			{
				element=document.createElement("div")
				element.className="wartosc wartoscDuza nieklikalna"
				element.innerHTML=`średni czas trasy: ${Math.floor(listaTras[0])}h i ${(listaTras[0]%1)*60}min`
				t.appendChild(element)
			}
			element=document.createElement("div")
			element.className="separator"
			t.appendChild(element)
			//
			const miesiace=JSON.parse(localStorage.getItem("AgroNotatnik-miesiace")||"[]")||[]
			for (let a=(funkcjeCzasu.aktualnaData()[2])-2022 ; a>=0 ; a--)
			{
				if (Array.isArray(miesiace[a]))
				{
					for (let b=12 ; b>0 ; b--)
					{
						if (Array.isArray(miesiace[a][b]))
						{
							element=document.createElement("div")
							element.className="wartosc wartoscDuza nieklikalna"
							element.innerHTML=`${["","Styczeń","Luty","Marzec","Kwiecień","Maj","Czerwiec","Lipiec","Sierpień","Wrzesień","Październik","Listopad","Grudzień",""][b]} ${a+2022}r`
							t.appendChild(element)
							const suma=Math.round(miesiace[a][b].reduce((a,b)=>{return a+b},0)/2)/2
							element=document.createElement("div")
							element.className="wartosc wartoscDuza nieklikalna"
							element.innerHTML=`suma godzin: ${suma}h`
							t.appendChild(element)
							element=document.createElement("div")
							element.className="wartosc wartoscDuza nieklikalna"
							element.innerHTML=`średnia czas: ${Math.round(suma*2/miesiace[a][b].length)/2}h`
							t.appendChild(element)
							element=document.createElement("div")
							element.className="wartosc wartoscDuza nieklikalna"
							element.innerHTML=`ilość kursów: ${miesiace[a][b].length}`
							t.appendChild(element)
						}
					}
				}
			}
			element=document.createElement("div")
			element.className="separator"
			t.appendChild(element)
			//
			const nazwyTras=JSON.parse(localStorage.getItem("AgroNotatnik-nazwyTras")||`[]`)||[]
			element=document.createElement("div")
			element.className="wartosc wartoscDuza nieklikalna"
			element.innerHTML="ilości kursów i średni czas"
			t.appendChild(element)
			const trasy=[[],[]]
			for (let a=0 ; a<nazwyTras.length ; a++)
			{
				let trasa=JSON.parse(localStorage.getItem("AgroNotatnik-trasa-"+(nazwyTras[a]||"?"))||"0")
				if (trasa)
				{
					trasy[0].push([trasa[0],trasa[1],trasa[2].length,1])
				}
			}
			for (let a=0 ; a<trasy[0].length ; a++)
			{
				const max=[0,0]
				for (let b=0 ; b<trasy[0].length ; b++)
				{
					if (trasy[0][b][3] && trasy[0][b][2]>max[1])
					{
						max[1]=trasy[0][b][2]
						max[0]=b
					}
				}
				if (max[1]>1)
				{
					trasy[1].push(trasy[0][max[0]])
					trasy[0][max[0]][3]=0
				}
			}
			for (let a=0 ; a<trasy[1].length ; a++)
			{
				element=document.createElement("div")
				element.className="wartosc wartoscDuza nieklikalna"
				if (trasy[1][a][2]>40)
				{
					element.innerHTML=`ponad 40 na ${trasy[1][a][0]} ${Math.round(trasy[1][a][1]*2)/2}h `
				}
				else
				{
					element.innerHTML=`${trasy[1][a][2]} na ${trasy[1][a][0]} ${Math.round(trasy[1][a][1]*2)/2}h `
				}
				t.appendChild(element)
			}
			t.appendChild(element)
			ekran.wstaw(t)
		},
		dlaSzefa:function()
		{
			ekran.czysc()
			const t=document.createElement("div")
			let element=document.createElement("div")
			element.className="wartosc wartoscDuza"
			element.innerHTML="wróć do menu"
			element.onclick=ekran.menuGlowne
			t.appendChild(element)
			element=document.createElement("div")
			element.className="separator"
			t.appendChild(element)
			//
			const listaTras=JSON.parse(localStorage.getItem("AgroNotatnik-listaTras")||"[0]")||[0]
			let z=45
			let s=""
			const miesiac=[0,0,0,0,0,0,0,0,0,0,0,0,0]
			for (let a=listaTras.length-1 ; a>0 ; a--)
			{
				if (z<1){break}
				const trasaNr=JSON.parse(localStorage.getItem("AgroNotatnik-trasaNr-"+a))
				if (trasaNr && typeof trasaNr=="object")
				{
					s+=`Dnia ${funkcjeCzasu.pokazDate(trasaNr.czasStart[1])} trasa na ${trasaNr.nazwa}<br>`
					s+=`${Math.round(trasaNr.czasTrwania/30)/2}h od ${funkcjeCzasu.pokazGodzine(trasaNr.czasStart[0])} do ${funkcjeCzasu.pokazGodzine(trasaNr.czasKoniec[0])}<br><br>`
					miesiac[trasaNr.czasStart[1][1]]+=trasaNr.czasTrwania
				}
				z--
			}
			const max=[0,0]
			for (let a=0 ; a<miesiac.length ; a++)
			{
				if (miesiac[a]>max[1])
				{
					max[1]=miesiac[a]
					max[0]=a
				}
			}
			if (max[0]>0 && max[1]>0)
			{
				s+=`Łącznie ${Math.round(max[1]/30)/2}h w miesiącu ${max[0]}`
			}
			element=document.createElement("div")
			element.innerHTML=s
			t.appendChild(element)
			ekran.wstaw(t)
		},
		trasa:function(nrTrasy)
		{
			ekran.czysc()
			const t=document.createElement("div")
			let element=document.createElement("div")
			element.className="wartosc wartoscDuza"
			element.innerHTML="Wróć do menu"
			element.onclick=ekran.menuGlowne
			t.appendChild(element)
			element=document.createElement("div")
			element.className="separator"
			t.appendChild(element)
			//
			const trasaNr=JSON.parse(localStorage.getItem("AgroNotatnik-trasaNr-"+nrTrasy))
			if (!trasaNr || typeof trasaNr!="object"){return}
			element=document.createElement("div")
			element.className="wartosc wartoscDuza nieklikalna"
			element.innerHTML=`${trasaNr.nazwa}`
			t.appendChild(element)
			element=document.createElement("div")
			element.className="wartosc wartoscDuza nieklikalna"
			element.innerHTML=`Start dnia ${funkcjeCzasu.pokazDate(trasaNr.czasStart[1])}`
			t.appendChild(element)
			element=document.createElement("div")
			element.className="wartosc wartoscDuza nieklikalna"
			if (trasaNr.czasStart[2] && trasaNr.czasKoniec[2])
			{
				element.innerHTML=`${funkcjeCzasu.pokazGodzine(trasaNr.czasStart[0])}e => ${funkcjeCzasu.pokazGodzine(trasaNr.czasKoniec[0])}e`
			}
			else if(trasaNr.czasStart[2])
			{
				element.innerHTML=`${funkcjeCzasu.pokazGodzine(trasaNr.czasStart[0])}e => ${funkcjeCzasu.pokazGodzine(trasaNr.czasKoniec[0])}`
			}
			else if(trasaNr.czasKoniec[2])
			{
				element.innerHTML=`${funkcjeCzasu.pokazGodzine(trasaNr.czasStart[0])} => ${funkcjeCzasu.pokazGodzine(trasaNr.czasKoniec[0])}e`
			}
			else
			{
				element.innerHTML=`${funkcjeCzasu.pokazGodzine(trasaNr.czasStart[0])} => ${funkcjeCzasu.pokazGodzine(trasaNr.czasKoniec[0])}`
			}
			t.appendChild(element)
			element=document.createElement("div")
			element.className="wartosc wartoscDuza nieklikalna"
			if (trasaNr.czasTrwania%60)
			{
				element.innerHTML=`${Math.floor(trasaNr.czasTrwania/60)}h i ${trasaNr.czasTrwania%60}min`
			}
			else
			{
				element.innerHTML=`${Math.floor(trasaNr.czasTrwania/60)}h`
			}
			t.appendChild(element)
			let trasa=JSON.parse(localStorage.getItem("AgroNotatnik-trasa-"+(trasaNr.nazwa||"?"))||"0")
			if (trasa && typeof trasa=="object")
			{
				console.log(trasa)
				if (trasa[1]>0)
				{
					element=document.createElement("div")
					element.className="wartosc wartoscDuza nieklikalna"
					if (trasaNr.czasTrwania/60<=trasa[1])
					{
						element.innerHTML=`Dobry czas`
						element.style.color="#D9F739"
					}
					else
					{
						element.innerHTML=`Czas powyżej normy`
						element.style.color="#F74D39"
					}
					t.appendChild(element)
					element=document.createElement("div")
					element.className="separator"
					t.appendChild(element)
					element=document.createElement("div")
					element.className="wartosc wartoscDuza nieklikalna"
					if (trasa[1]%1)
					{
						element.innerHTML=`Zazwyczaj ${Math.floor(trasa[1])}h i ${(trasa[1]%1)*60}min`
					}
					else
					{
						element.innerHTML=`Zazwyczaj ${Math.floor(trasa[1])}h`
					}
					t.appendChild(element)
				}
				else
				{
					element=document.createElement("div")
					element.className="separator"
					t.appendChild(element)
				}
				if (trasa[2].length>25)
				{
					element=document.createElement("div")
					element.className="wartosc wartoscDuza nieklikalna"
					element.innerHTML=`Łącznie ponad 25 kursów`
					t.appendChild(element)
				}
				else if (trasa[2].length>1)
				{
					element=document.createElement("div")
					element.className="wartosc wartoscDuza nieklikalna"
					if (trasa[2].length<5)
					{
						element.innerHTML=`Łącznie ${trasa[2].length} kursy`
					}
					else
					{
						element.innerHTML=`Łącznie ${trasa[2].length} kursów`
					}
					t.appendChild(element)
				}
			}
			element=document.createElement("div")
			element.className="separator"
			t.appendChild(element)
			element=document.createElement("div")
			element.className="separator"
			t.appendChild(element)
			element=document.createElement("div")
			element.className="wartosc wartoscDuza"
			element.innerHTML="Popraw wprowadzony czas"
			element.onclick=new Function(`ekran.edytuj(${nrTrasy})`)
			t.appendChild(element)
			ekran.wstaw(t)
		},
		edytuj:function(nrTrasy)
		{
			edytowanaTrasa=JSON.parse(localStorage.getItem("AgroNotatnik-trasaNr-"+nrTrasy))
			ekran.czysc()
			const t=document.createElement("div")
			let element=document.createElement("div")
			element.className="wartosc wartoscDuza"
			element.innerHTML="Wróć do menu"
			element.onclick=ekran.menuGlowne
			t.appendChild(element)
			element=document.createElement("div")
			element.className="separator"
			t.appendChild(element)
			//
			if (!edytowanaTrasa || typeof edytowanaTrasa!="object"){return}
			element=document.createElement("div")
			element.className="wartosc wartoscDuza nieklikalna"
			element.innerHTML=`${edytowanaTrasa.nazwa}`
			t.appendChild(element)
			//
			element=document.createElement("div")
			element.className="wartosc wartoscDuza nieklikalna"
			element.innerHTML=`Poprawny czas rozpoczęcia:`
			t.appendChild(ekran.elementCzas("edytowanaTrasa.czasStart"))
			element=document.createElement("div")
			element.className="separator"
			t.appendChild(element)
			element=document.createElement("div")
			element.className="wartosc wartoscDuza nieklikalna"
			element.innerHTML=`Poprawny czas zakończenia:`
			t.appendChild(ekran.elementCzas("edytowanaTrasa.czasKoniec"))
			element=document.createElement("div")
			element.className="separator"
			t.appendChild(element)
			element=document.createElement("div")
			element.className="wartosc wartoscDuza"
			element.innerHTML="zapisz"
			element.onclick = new Function(`edytujTrase(${nrTrasy})`)
			t.appendChild(element)
			ekran.wstaw(t)
		},
	}
	funkcjeCzasu=
	{
		aktualnaGodzina:function()
		{
			const teraz = new Date()
			return [teraz.getHours(),teraz.getMinutes()]
		},
		aktualnaData:function()
		{
			const teraz = new Date()
			return [teraz.getDate(),teraz.getMonth()+1,teraz.getFullYear()]
		},
		poprawnaData(data)
		{
			data=JSON.parse(JSON.stringify(data))
			const teraz = new Date(data[1][2],data[1][1]-1,data[1][0],data[0][0],data[0][1])
			if (teraz.getHours()!=data[0][0]){console.log("niezgodność godzin");return false}
			if (teraz.getMinutes()!=data[0][1]){console.log("niezgodność minut");return false}
			if (teraz.getDate()!=data[1][0]){console.log("niezgodność dnia");return false}
			if (teraz.getMonth()!=(data[1][1]-1)){console.log("niezgodność miesiąca");return false}
			return true
		},
		dzienTygodnia(data)
		{
			const teraz = new Date(data[2],data[1]-1,data[0])
			return ["Niedziela","Poniedziałek","Wtorek","Środa","Czwartek","Piątek","Sobota","Niedziela"][teraz.getDay()||0]
		},
		roznicaCzasu(data1,data2)
		{
			const teraz1 = new Date(data1[1][2],data1[1][1],data1[1][0],data1[0][0],data1[0][1])
			const teraz2 = new Date(data2[1][2],data2[1][1],data2[1][0],data2[0][0],data2[0][1])
			return Math.floor(Math.abs(teraz2-teraz1)/60000)
		},
		dodajMinuty(minuty,czas)
		{
			czas=czas||[funkcjeCzasu.aktualnaGodzina(),funkcjeCzasu.aktualnaData()]
			czas[0][1]+=minuty
			return funkcjeCzasu.ogarnij(czas)
		},
		dodajDzien(czas)
		{
			czas=czas||[funkcjeCzasu.aktualnaGodzina(),funkcjeCzasu.aktualnaData()]
			czas[1][0]++
			return funkcjeCzasu.ogarnij(czas)
		},
		odejmijDzien(czas)
		{
			czas=czas||[funkcjeCzasu.aktualnaGodzina(),funkcjeCzasu.aktualnaData()]
			czas[1][0]--
			return funkcjeCzasu.ogarnij(czas)
		},
		ogarnij:function(czas)
		{
			if (czas[0][1]>59)
			{
				let zabezpieczenie=777
				while(zabezpieczenie && czas[0][1]>59)
				{
					zabezpieczenie--
					czas[0][0]++
					czas[0][1]-=60
				}
			}
			else if (czas[0][1]<0)
			{
				let zabezpieczenie=777
				while(zabezpieczenie && czas[0][1]<0)
				{
					zabezpieczenie--
					czas[0][0]--
					czas[0][1]+=60
				}
			}
			//
			if (czas[0][0]>23)
			{
				let zabezpieczenie=777
				while(zabezpieczenie && czas[0][0]>23)
				{
					zabezpieczenie--
					czas[1][0]++
					czas[0][0]-=24
				}
			}
			else if (czas[0][0]<0)
			{
				let zabezpieczenie=777
				while(zabezpieczenie && czas[0][0]<0)
				{
					zabezpieczenie--
					czas[1][0]--
					czas[0][0]+=24
				}
			}
			//
			if (czas[1][0]>31)
			{
				let zabezpieczenie=777
				while(zabezpieczenie && czas[1][0]>31)
				{
					zabezpieczenie--
					czas[1][1]++
					czas[1][0]-=31
				}
			}
			else if (czas[1][0]<1)
			{
				let zabezpieczenie=777
				while(zabezpieczenie && czas[1][0]<1)
				{
					zabezpieczenie--
					czas[1][1]--
					czas[1][0]+=31
				}
			}
			//
			if (czas[1][1]>31)
			{
				let zabezpieczenie=777
				while(zabezpieczenie && czas[1][1]>31)
				{
					zabezpieczenie--
					czas[1][2]++
					czas[1][1]-=31
				}
			}
			else if (czas[1][1]<1)
			{
				let zabezpieczenie=777
				while(zabezpieczenie && czas[1][1]<1)
				{
					zabezpieczenie--
					czas[1][2]--
					czas[1][1]+=31
				}
			}
			return czas
		},
		pokazGodzine:function(godzina)
		{
			godzina=JSON.parse(JSON.stringify(godzina||funkcjeCzasu.aktualnaGodzina()))
			godzina=[`${godzina[0]}`,`${godzina[1]}`]
			if(godzina[0].length<2){godzina[0]=`0${godzina[0]}`}
			if(godzina[1].length<2){godzina[1]=`0${godzina[1]}`}
			return `${godzina[0]}:${godzina[1]}`
		},
		pokazDate:function(data)
		{
			data=JSON.parse(JSON.stringify(data||funkcjeCzasu.aktualnaData()))
			data=[`${data[0]}`,`${data[1]}`,`${data[2]}`]
			if(data[0].length<2){data[0]=`0${data[0]}`}
			if(data[1].length<2){data[1]=`0${data[1]}`}
			return `${data[0]}.${data[1]}.${data[2]}r`
		}
	}
	function szukajTrasy()
	{
		wyszukaneTrasy=[]

		const nazwa=document.getElementById("poleSzukaj").value
		setTimeout(()=>{document.getElementById("poleSzukaj").value=nazwa},1)
		const nazwyTras=JSON.parse(localStorage.getItem("AgroNotatnik-nazwyTras")||"0")
		if (!nazwyTras)
		{
			domyslneNazwyTras()
			return szukajTrasy()
		}
		if (!nazwyTras || !Array.isArray(nazwyTras))
		{
			wyszukaneTrasy=[]
			return
		}
		if (nazwyTras.length<1)
		{
			wyszukaneTrasy=[]
			return
		}
		const t=[[],[],[]]
		for (let a=0 ; a<nazwyTras.length ; a++)
		{
			t[0][a]=[nazwyTras[a],podobienstwo(nazwyTras[a],nazwa),1]
		}
		for (let a=0 ; a<t[0].length ; a++)
		{
			const max=[0,0]
			for (let b=0 ; b<t[0].length ; b++)
			{
				if (t[0][b][2] && t[0][b][1]>max[1])
				{
					max[1]=t[0][b][1]
					max[0]=b
				}
			}
			if (max[1]>5)
			{
				t[1].push(t[0][max[0]])
				t[0][max[0]][2]=0
			}
			if (t[1].length>2){break}
		}
		for (let a=0 ; a<t[1].length ; a++)
		{
			t[3]=JSON.parse(localStorage.getItem("AgroNotatnik-trasa-"+t[1][a][0])||"0")
			if (t[3] && typeof t[3]=="object")
			{
				wyszukaneTrasy.push(t[3])
			}
			else
			{
				wyszukaneTrasy.push([t[1][a][0],0,[]])
			}
		}
		ekran.nowa()
	}
	function utworzNowaTrase(nazwa)
	{
		if (!nazwa && wyszukaneTrasy.length==0)
		{
			const nazwa=document.getElementById("poleSzukaj").value
			const nazwyTras=JSON.parse(localStorage.getItem("AgroNotatnik-nazwyTras")||`0`)
			if (!nazwyTras)
			{
				domyslneNazwyTras()
				return szukajTrasy()
			}
			if (nazwyTras && Array.isArray(nazwyTras))
			{
				for (let a=0 ; a<nazwyTras.length ; a++)
				{
					if (podobienstwo(nazwyTras[a],nazwa)>24)
					{
						return szukajTrasy()
					}
				}
			}
		}
		else if (nazwa.length>15)
		{
			alert("nazwa trasy nie może być taka długa")
			return
		}
		if (JSON.parse(localStorage.getItem("AgroNotatnik-trasaTeraz")||"0")){return}
		console.log(JSON.stringify(trasaTeraz.czasStart))
		if (funkcjeCzasu.poprawnaData(trasaTeraz.czasStart))
		{
			trasaTeraz.nazwa=duzeLitery(nazwa||document.getElementById("poleSzukaj").value)
			if (!trasaTeraz.nazwa || typeof trasaTeraz.nazwa!="string"){return}
			if (trasaTeraz.nazwa.length<3){return}
			localStorage.setItem("AgroNotatnik-trasaTeraz",JSON.stringify(trasaTeraz))
			ekran.menuGlowne()
		}
	}
	function zakonczTrase()
	{
		if (!funkcjeCzasu.poprawnaData(trasaTeraz.czasKoniec)){return}
		trasaTeraz.czasTrwania=funkcjeCzasu.roznicaCzasu(trasaTeraz.czasStart,trasaTeraz.czasKoniec)
		if (trasaTeraz.czasTrwania<30 || trasaTeraz.czasTrwania>1020){alert(`wkradł się jakiś błąd. Czas trwania kursu jest zbyt krótki lub zbyt długi.`);console.log(`zbyt krótki lub zbyt długi czas trwania (${trasaTeraz.czasTrwania})`);return}
		console.log(JSON.stringify(trasaTeraz))
		const listaTras=JSON.parse(localStorage.getItem("AgroNotatnik-listaTras")||"[0]")||[0]
		const nrTrasy=listaTras.length
		localStorage.setItem("AgroNotatnik-trasaNr-"+nrTrasy,JSON.stringify(trasaTeraz))
		listaTras.push([trasaTeraz.nazwa,trasaTeraz.czasStart[1],trasaTeraz.czasTrwania])
		if (listaTras.length>3)
		{
			listaTras[0]=srednia(listaTras,2)
		}
		localStorage.setItem("AgroNotatnik-listaTras",JSON.stringify(listaTras))
		//
		const miesiace=JSON.parse(localStorage.getItem("AgroNotatnik-miesiace")||"[]")||[]
		if (!Array.isArray(miesiace[trasaTeraz.czasStart[1][2]-2022]))
		{
			miesiace[trasaTeraz.czasStart[1][2]-2022]=[]
		}
		if (!Array.isArray(miesiace[trasaTeraz.czasStart[1][2]-2022][trasaTeraz.czasStart[1][1]]))
		{
			miesiace[trasaTeraz.czasStart[1][2]-2022][trasaTeraz.czasStart[1][1]]=[]
		}
		miesiace[trasaTeraz.czasStart[1][2]-2022][trasaTeraz.czasStart[1][1]].push(Math.round(trasaTeraz.czasTrwania/15))
		localStorage.setItem("AgroNotatnik-miesiace",JSON.stringify(miesiace))
		//
		let trasa=JSON.parse(localStorage.getItem("AgroNotatnik-trasa-"+(trasaTeraz.nazwa||"?"))||"0")
		if (!trasa)
		{
			trasa=[trasaTeraz.nazwa,0,[]]
			const nazwyTras=JSON.parse(localStorage.getItem("AgroNotatnik-nazwyTras")||`[]`)||[]
			nazwyTras.push(duzeLitery(trasaTeraz.nazwa))
			localStorage.setItem("AgroNotatnik-nazwyTras",JSON.stringify(nazwyTras))
		}
		trasa[2].unshift([nrTrasy,trasaTeraz.czasTrwania])
		trasa[2]=trasa[2].slice(0,50)
		if (trasa[2].length>2)
		{
			trasa[1]=srednia(trasa[2],1)
		}
		localStorage.setItem("AgroNotatnik-trasa-"+trasaTeraz.nazwa,JSON.stringify(trasa))
		//
		localStorage.setItem("AgroNotatnik-trasaTeraz","0")
		ekran.menuGlowne()
	}
	function anulujTrase()
	{
		localStorage.setItem("AgroNotatnik-trasaTeraz","0")
		ekran.menuGlowne()
	}
	function podobienstwo(s1,s2)
	{
		let t=0
		s1="<"+(s1||"").toLowerCase()+">"
		s2="<"+(s2||"").toLowerCase()+">"
		for (let a=1 ; a<s1.length-1 ; a++)
		{
			for (let b=1 ; b<s2.length-1 ; b++)
			{
				if (s1[a]==s2[b])
				{
					if ((s1[a-1]==s2[b-1]) && (s1[a+1]==s2[b+1]))
					{
						t+=3
						break
					}
				}
			}
			for (let b=1 ; b<s2.length-1 ; b++)
			{
				if (s1[a]==s2[b])
				{
					t++
				}
			}
		}
		return t
	}
	function duzeLitery(string)
	{
		if (!string || typeof string!="string"){return ""}
		let s=string[0].toUpperCase()
		for (let a=1 ; a<string.length ; a++)
		{
			if (string[a-1]==" ")
			{
				s+=string[a].toUpperCase()
			}
			else
			{
				s+=string[a].toLowerCase()
			}
		}
		return s
	}
	function srednia(lista,e)
	{
		const g=[]
		let suma=0
		let wagi=0
		for (let a=0 ; a<lista.length ; a++)
		{
			if (!lista[a] || typeof lista[a]!="object"){continue}
			const waga=(51-a)
			g[Math.ceil(lista[a][e]/30)*4]=(g[Math.ceil(lista[a][e]/30)*4]||0)+1
			suma+=Math.ceil(lista[a][e]/15)*waga
			wagi+=waga
		}
		suma=suma/wagi
		const max=[0,0]
		for (let a=0 ; a<g.length ; a++)
		{
			if (g[a]>max[1])
			{
				max[1]=g[a]
				max[0]=a
			}
		}
		if (max[0]>0)
		{
			suma=((suma*2)+max[0])/3
		}
		return Math.ceil(suma)/4
	}
	function domyslneNazwyTras()
	{
		//
		localStorage.setItem("AgroNotatnik-nazwyTras",`["Niałek","Smardzewo","Jordanowo","Mdzrz. Wyb.","Międzyrzecz","Templewo","Bledzew","Trzemeszno L.","Lubniewice","Sulęcin","Ośno L.","Baranowo","Kiekrz","Rokietnica","Mrowino","Pamiątkowo","Chludowo","Biedrusko","Kicin","Koziegłowy","Poznań","Czapury","Boszkowo","Bucz","Przemęt","Mochy","Wroniawy","Kębłowo","Obra","Świętno","Kaszczor","Brenno","Wijewo","Grębocice","Jerzmanowa","Nielubia","Bytom Od.","Nowa Sól","Modrzyca","Otyń","Przyborów","Siedlisko","Granowo","Strykowo","Rybojedzko","Opalenica","Wielka Wieś","Grzebienisko","Duszniki","Bytyń","Kaźmierz","Tarnowo","Lusowo","Lusówko","Ołobok","Świebodzin","Lubrza","Brójce","Bukowiec","Trzciel","Pszczew","Łowyń","Przytoczna","Skwierzyna","Krotoszyn","Konarzew","Zduny","Cieszków","Pęcław","Głogów","Ruszowice","Kotla","Krzepielów","Zielona Góra","Świdnica","Leśniów Wielki","Dąbie","Bobrowice","Połupin","Wężyska","Gubin","Jarocin","Wilkowyja","Dobieszczyzna","Gizałki","Broniszewice","Chocz","Janków Drugi","Gołuchów","Gułtowy","Nekla","Przyborki","Psary Pl","Sokołowo","Gutowo M.","Września","Bierzglinek","Pawłowice","Kąkolewo","Krzemieniewo","Gola","Gostyń","Bodzewo","Niedoradz","Racula","Droszków","Zabór","S.Kisielin","Czerwieńsk","Płoty","Przylep","Wilkanowo","Koninko","Kamionki","Robakowo","Bnin","Środa Wlkp","Dominowo","Murzynowo","Sulęcinek","Orzechowo","Chrzan","Żerków","Komorniki","Plewiska","Skórzewo","Zakrzewo","Palędzie","Dopiewo","Konarzewo","Stęszew","Witobel","Mosina","Pecna","Kłoda","Rydzyna","Czernina","Witoszyce","Góra","Kuślin","Wąsowo","Glinno","N. Tomyśl","Przyłęk","Bolewice","Lwówek","Pakosław NT","Pniewy","Podpniewki","Kwilcz","Poniec","Pudliszki","Krobia","Pępowo","Bojadła","Trzebiechów","Sulechów","Kije","Skąpe","Nietkowice","Bytnica","Krosno O.","Marcinowice","Maszewo","Oleśnica","Ligota Wielka","Zbytowa","Stradomia W.","N. Dwór (ol.)","Syców","Twardogóra","Moszyce","Goszcz","Krośnice","Milicz","Sulmierzyce","Raczyce","Odolanów","Granowiec","Sośnie","Międzybórz","Czarnylas","Tarchały W.","Janków P.","Topola Mała","Gorzyce W.","Mikstat","Bukownica","Doruchów","Grabów","Kraszewice","Czajków","Kargowa","Kolesin","Szczaniec","Dąbrówka","Zbąszynek","Babimost","Chobienice","Siedlec (wlkp)","Oborniki Śl.","Ligota Piękna","Trzebnica","Zawonia","Dobroszyce","Bukowice","Sułów","Szkaradowo","Borek Wlkp","Rusko","Siedlemin","Zakrzew","Witaszyce","Kotlin","Czermin","Niechlów","Szlichtyngowa","Jędrzychowice","Wschowa","Sława","Kolsko","Konotop","Lubięcin","Przygodzice","Wysocko W.","Wtórek","Strzyżew","Sieroszewice","Wielowieś","W. Droszewska","Kaliszkowice","Chobienia","Jemielno","Wińsko","Pełczyn (dol)","Skokowa","Prusice","Żmigród","Korzeńsko","Folwark","Wąsosz","Leszno","Lipno","Wilkowice","Krzycko W.","Bukówiec Górny","Włoszakowice","Śmigiel","Nowa Wieś","Widziszewo","S. Bojanowo","Zalasewo","Gowarzewo","Siekierki W.","Paczkowo","Pobiedziska","Kostrzyn","Łagów","Torzym","Rzepin","Kunowice","Cybinka","Kobierno","Orpiszew","Biadki","Łąkociny","Lamki","Ostrów","Przybysławice","Raszków","Ligota (ostr)","Koźminiec","Siedlec (dol)","Wrocław","Kamieniec Wr.","Czernica","Jelcz L.","Stanowice","Siechnice","Św Katarzyna","Dziadowa Kłoda","Perzów","Kobyla Góra","Rojów","Rogaszyce","Olszyna","Ostrzeszów","Siedlików","Miłosław","Kołaczkowo","Sokolniki","Ciążeń","Lądek","Zagórów","Pyzdry","Komorze P.","Krzywiń","Bielewo","Bieżyń","Jerka","Turew","Czempiń","S. Oborzyska","N. Lubosz","Racot","Kościan","Sobótka (wlkp)","Lewków","Biskupice O.","Skalmierzyce","Kalisz","Wilkowo Pl","Wielichowo","Łubnica","Rakoniewice","Łąkie","Rostarzewo","Adamowo","Wolsztyn","Piaski","Jaraczewo","Chwałkowo","Książ","Chocicza","N. M. Nad Wartą","Klęka","Mieszków","Cielcza","Tuchorza","Belęcin","Przyprostynia","Zbąszyń","Paproć","Boruja K.","Jabłonna","Wydawy","Słupia K.","Chojno","Pakosław Raw","Nowy Sielec","Jutrosin","Smolice","Kobylin","Golina","Borzęcice","Dobrzyca","Kowalew","Pleszew","Pogorzela","Borzęciczki","Koźmin Wlkp","Rozdrażew","Benice","Dąbcze","Strzyżewice","Osieczna","Świerczyna","Brodnica","Śrem","Nochowo","Dolsk","Kunowo","Sierakowo","Kiełczewo","Maksymilianowo","Kamieniec","Grodzisk","Golina Wielka","Bojanowo","Rawicz","Sarnowa","Miejska Górka","Konary","Niepart","Skoraszewice","Długołęka"]`)
	}
	function edytujTrase(nrTrasy)
	{
		if (!funkcjeCzasu.poprawnaData(edytowanaTrasa.czasKoniec)){return}
		const poprzedniCzasTrwania=edytowanaTrasa.czasTrwania
		edytowanaTrasa.czasTrwania=funkcjeCzasu.roznicaCzasu(edytowanaTrasa.czasStart,edytowanaTrasa.czasKoniec)
		if (edytowanaTrasa.czasTrwania<30 || edytowanaTrasa.czasTrwania>1020){alert(`wkradł się jakiś błąd. Czas trwania kursu jest zbyt krótki lub zbyt długi.`);console.log(`zbyt krótki lub zbyt długi czas trwania (${edytowanaTrasa.czasTrwania})`);return}
		console.log(JSON.stringify(edytowanaTrasa))
		localStorage.setItem("AgroNotatnik-trasaNr-"+nrTrasy,JSON.stringify(edytowanaTrasa))
		//
		const listaTras=JSON.parse(localStorage.getItem("AgroNotatnik-listaTras")||"[0]")||[0]
		listaTras[nrTrasy]=[edytowanaTrasa.nazwa,edytowanaTrasa.czasStart[1],edytowanaTrasa.czasTrwania]
		if (listaTras.length>3)
		{
			listaTras[0]=srednia(listaTras,2)
		}
		localStorage.setItem("AgroNotatnik-listaTras",JSON.stringify(listaTras))
		//
		const miesiace=JSON.parse(localStorage.getItem("AgroNotatnik-miesiace")||"[]")||[]
		if (!Array.isArray(miesiace[edytowanaTrasa.czasStart[1][2]-2022]))
		{
			miesiace[edytowanaTrasa.czasStart[1][2]-2022]=[]
		}
		if (!Array.isArray(miesiace[edytowanaTrasa.czasStart[1][2]-2022][edytowanaTrasa.czasStart[1][1]]))
		{
			miesiace[edytowanaTrasa.czasStart[1][2]-2022][edytowanaTrasa.czasStart[1][1]]=[]
		}
		const tenMiesiac=miesiace[edytowanaTrasa.czasStart[1][2]-2022][edytowanaTrasa.czasStart[1][1]]
		for (let a=0 ; a<(tenMiesiac||[]).length ; a++)
		{
			if (tenMiesiac[a]==Math.round(poprzedniCzasTrwania/15))
			{
				tenMiesiac[a]=Math.round(edytowanaTrasa.czasTrwania/15)
			}
		}
		localStorage.setItem("AgroNotatnik-miesiace",JSON.stringify(miesiace))
		//
		let trasa=JSON.parse(localStorage.getItem("AgroNotatnik-trasa-"+(edytowanaTrasa.nazwa||"?"))||"0")
		if (!trasa)
		{
			console.log("to niemożliwe. wystąpił błąd (S44)")
			return ekran.menuGlowne()
		}
		if (trasa[2].length>2)
		{
			trasa[1]=srednia(trasa[2],1)
		}
		localStorage.setItem("AgroNotatnik-trasa-"+trasaTeraz.nazwa,JSON.stringify(trasa))
		//
		ekran.menuGlowne()
	}
</script>
<body onload="ekran.menuGlowne()">
	<div id="glowny">
	</div>
</body>
</html>